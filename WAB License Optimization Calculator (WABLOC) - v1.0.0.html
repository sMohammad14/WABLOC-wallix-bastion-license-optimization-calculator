<!DOCTYPE html><html lang="en" dir="ltr"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>WAB License Optimization Calculator (WABLOC) - v1.0.0</title><style>:root{--tt-val:#333;--tt-dim:#666;--tt-lbl:#b34700;--tt-ok:#008000;--tt-err:#cc0000;--primary-color:#f27324;--light-bg:#f4f4f9;--light-text:#333;--dark-bg:#121212;--dark-text:#e0e0e0;--light-panel-bg:#fff8f0;--dark-panel-bg:#1e1e1e;--light-border:#ddd;--dark-border:#444;}body{font-family:Tahoma,Arial,sans-serif;margin:0;padding:15px;background-color:var(--light-bg);color:var(--light-text);transition:background-color 0.3s,color 0.3s;position:relative;text-align:center;}h1{text-align:center;color:var(--primary-color);margin-bottom:20px;font-size:1.8em;}body.dark-mode{background-color:var(--dark-bg);color:var(--dark-text);}body.dark-mode h1{color:var(--primary-color);}body.dark-mode #drop-area,body.dark-mode .card{background-color:var(--dark-panel-bg);border-color:var(--dark-border);color:var(--dark-text);}body.dark-mode #export-instructions{background-color:#2b2b2b;border-color:var(--primary-color);color:var(--dark-text);}#theme-toggle-container{position:absolute;top:25px;right:25px;z-index:2000;display:flex;align-items:center;}#theme-toggle-button{position:relative;display:inline-block;width:40px;height:20px;cursor:pointer;}#theme-toggle-button input{opacity:0;width:0;height:0;}.slider{position:absolute;cursor:pointer;top:0;left:0;right:0;bottom:0;background-color:#ccc;transition:.4s;border-radius:20px;}.slider:before{position:absolute;content:"";height:16px;width:16px;left:2px;bottom:2px;background-color:white;transition:.4s;border-radius:50%;}#theme-mode-toggle:checked+.slider{background-color:var(--primary-color);}#theme-mode-toggle:checked+.slider:before{transform:translateX(20px);}#theme-icon{font-size:1.2em;margin-right:8px;cursor:pointer;transition:color 0.3s;}body.dark-mode #theme-icon{color:white;}body:not(.dark-mode) #theme-icon{color:#333;}#export-instructions{border:1px solid var(--primary-color);border-radius:8px;padding:15px;margin:0 auto 20px auto;max-width:90%;background-color:var(--light-panel-bg);font-size:0.95em;line-height:1.6;transition:background-color 0.3s,border-color 0.3s;text-align:left;}#export-instructions h3{color:var(--primary-color);margin-top:0;margin-bottom:8px;font-size:1.1em;}.highlight-setting{color:var(--primary-color);text-decoration:underline;text-decoration-color:black;}#drop-area{border:2px dashed #ccc;border-radius:10px;padding:30px 20px;text-align:center;margin-bottom:15px;background-color:white;transition:background-color 0.3s,border-color 0.3s;cursor:pointer;}#drop-area.highlight{background-color:#ffe0c8;border-color:var(--primary-color);}#drop-area p{margin:0;font-size:1em;color:#666;}body.dark-mode #drop-area p{color:#ccc;}#fileElem{display:none;}#progress-container{display:none;margin-top:20px;max-width:600px;margin-left:auto;margin-right:auto;}#bar-bg{width:100%;background:#eee;height:12px;border-radius:6px;overflow:hidden;margin-bottom:10px;}body.dark-mode #bar-bg{background:#444;}#bar-fill{width:0%;height:100%;background:var(--primary-color);transition:width 0.1s linear;}#status-text{font-size:14px;color:#666;}body.dark-mode #status-text{color:#aaa;}#stats-result{display:none;margin-top:20px;animation:fadeIn 1s;max-width:800px;margin-left:auto;margin-right:auto;}#stats-result h3{color:var(--light-text);border-bottom:2px solid var(--primary-color);padding-bottom:5px;display:inline-block;}body.dark-mode #stats-result h3{color:var(--dark-text);}.res-box{display:flex;justify-content:center;gap:20px;margin-top:20px;flex-wrap:wrap;}.card{background:#fff;border:1px solid #e0e0e0;padding:25px;border-radius:12px;text-align:left;font-size:1em;min-width:260px;box-shadow:0 4px 10px rgba(0,0,0,0.05);transition:transform 0.2s;}body.dark-mode .card{background-color:#2b2b2b;border-color:#444;color:#e0e0e0;box-shadow:0 4px 10px rgba(0,0,0,0.2);}.card:hover{transform:translateY(-3px);}.res-header{font-size:1.2em;font-weight:bold;color:var(--primary-color);margin-bottom:15px;border-bottom:1px solid rgba(242,115,36,0.3);padding-bottom:10px;}.res-row{display:flex;justify-content:space-between;margin-bottom:8px;font-size:1.05em;}.freed-row{margin-top:15px;padding-top:10px;border-top:1px dashed #ccc;font-size:1.15em;}body.dark-mode .freed-row{border-top-color:#555;}.freed-val{font-weight:bold;background:linear-gradient(90deg,#28a745 0%,#80ffaa 50%,#28a745 100%);background-size:200% auto;-webkit-background-clip:text;-webkit-text-fill-color:transparent;animation:shine 3s linear infinite;}.footer-link-container{text-align:center;margin-top:30px;padding-top:10px;border-top:1px solid #ddd;transition:border-top-color 0.3s;}body.dark-mode .footer-link-container{border-top-color:var(--dark-border);}.footer-link-container a{color:var(--primary-color);font-weight:bold;text-decoration:none;font-size:1em;}@keyframes fadeIn{from{opacity:0}to{opacity:1}}#contact-section{display:none;margin-top:40px;animation:fadeIn 1s;}.diamond-link{text-decoration:none;display:inline-flex;align-items:center;justify-content:center;gap:10px;padding:10px 30px;border-radius:30px;transition:transform 0.2s;background:rgba(255,255,255,0.05);border:1px solid rgba(242,115,36,0.3);}.diamond-link:hover{transform:scale(1.05);border-color:var(--primary-color);}.diamond-text{font-size:1.8em;font-weight:bold;background:linear-gradient(90deg,#888 0%,#fff 50%,#888 100%);background-size:200% auto;color:#333;-webkit-background-clip:text;-webkit-text-fill-color:transparent;animation:shine 3s linear infinite;text-shadow:0 0 10px rgba(255,255,255,0.1);}body.dark-mode .diamond-text{background:linear-gradient(90deg,#666 0%,#fff 50%,#666 100%);background-size:200% auto;-webkit-background-clip:text;}@keyframes shine{to{background-position:200% center;}}.contact-icon{font-size:1.5em;animation:pulse 2s infinite;}@keyframes pulse{0%{transform:scale(1);}50%{transform:scale(1.2);}100%{transform:scale(1);}}</style></head><body><div id="theme-toggle-container"><span id="theme-icon" onclick="document.getElementById('theme-mode-toggle').click();">ðŸŒ™</span><label id="theme-toggle-button"><input type="checkbox" id="theme-mode-toggle" onchange="handleThemeChange()"><span class="slider"></span></label></div><h1>WAB License Optimization Calculator (WABLOC) - v1.0.0</h1><div id="export-instructions"><h3>Required Export Instructions</h3><p>Please export the following 4 files in <strong>CSV</strong> format from the <strong>Left Menu>Import/Export>CSV</strong> path: <strong>âœ…Target groups</strong>, <strong>âœ…User groups</strong>, <strong>âœ…Devices</strong>, and <strong>âœ…Authorizations</strong>. (You may export all of them together and extract them from the zip file).</p><p style="font-weight: bold;"><span style="color: var(--primary-color);">Important Note:</span> Ensure the export settings are configured as follows: <span class="highlight-setting">âœ…Field separator must be set to SEMICOLON (;)</span> and the <span class="highlight-setting">âœ…List separator must be set to COMMA (,)</span>.</p></div><div id="drop-area"><p>Drag and Drop files here or click to select.</p><input type="file" id="fileElem" multiple accept=".csv"></div><div id="progress-container"><div id="bar-bg"><div id="bar-fill"></div></div><div id="status-text">Initializing Entropy Analysis...</div></div><div id="stats-result"><h3>Calculation Results</h3><div class="res-box" id="res-content"></div></div><div id="contact-section"><a href="https://t.me/alamalhoda" target="_blank" class="diamond-link"><span class="diamond-text">How to Optimize?</span></a></div><div class="footer-link-container">by <a href="https://github.com/sMohammad14" target="_blank">sMohammad14</a></div><script>var d={};function p(e){let t=e.trim().split("\r\n").filter(e=>""!==e.trim());if(t.length<2)return{h:[],d:[]};let n=t[1].split(";").map((e,t)=>0===t&&e.startsWith("#")?e.substring(1).trim():e.trim()).filter(e=>""!==e);return{h:n,d:t.slice(2).map(e=>{let t=e.split(";"),r={};return n.forEach((e,n)=>{r[e]=t[n]?t[n].trim():""}),r})}}function i(e,t){let n=p(t),r=n.h,o="";r.includes("Name")&&r.includes("Users")?o="u":r.includes("Name")&&r.includes("Target accounts")?o="t":r.includes("Name")&&r.includes("Host")?o="r":r.includes("Name")&&r.includes("Usergroup name")&&(o="a"),o&&(d[o]=n.d),Object.keys(d).length===4&&run()}function handle(e){d={};Array.from(e).filter(e=>e.name.toLowerCase().endsWith(".csv")).forEach(e=>{let t=new FileReader;t.onload=t=>i(e.name,t.target.result),t.readAsText(e)})}function run(){document.getElementById("drop-area").style.display="none";document.getElementById("progress-container").style.display="block";let e=0,t=document.getElementById("bar-fill"),n=document.getElementById("status-text"),r=["Decompiling Logic...","Calculating Logical Entropy...","Optimizing Token Paths...","Resolving Dependencies...","Finalizing Delta..."],o=setInterval(()=>{e+=100/(150);t.style.width=e+"%";let i=Math.floor((e/100)*r.length);n.innerText=r[i]||"Finalized";if(e>=100){clearInterval(o);show()}},100)}function show(){let e=document.getElementById("res-content"),u=calc("user"),t=calc("target");e.innerHTML=`<div class="card"><div class="res-header">User Logic Mode</div><div class="res-row"><span>Initial:</span><span>${u.o}</span></div><div class="res-row"><span>Optimized:</span><span>${u.u}</span></div><div class="res-row freed-row"><span>Freed:</span><span class="freed-val">${u.f}</span></div></div><div class="card"><div class="res-header">Target Logic Mode</div><div class="res-row"><span>Initial:</span><span>${t.o}</span></div><div class="res-row"><span>Optimized:</span><span>${t.u}</span></div><div class="res-row freed-row"><span>Freed:</span><span class="freed-val">${t.f}</span></div></div>`;document.getElementById("stats-result").style.display="block";document.getElementById("contact-section").style.display="block";}function calc(m){let t=getM(m),n=new Set;for(let r in t)t[r].forEach(e=>n.add(e));let o=n.size,a=new T;for(let s in t)t[s].forEach(e=>{e.match(/^\d{1,3}.\d{1,3}.\d{1,3}.\d{1,3}$/)&&a.ins(s,e)});let l=a.opt(),c=new Set;for(let g in l)l[g].forEach(e=>c.add(e));let u=c.size;return{o:o,u:u,f:o-u}}function getM(m){let e={};d.r.forEach(t=>{t.Host&&t.Name&&(e[t.Name]=t.Host)});let t={};d.t.forEach(n=>{let r=n.Name,o=[];["Target accounts","Account mapping","Interactive login","Accounts"].forEach(e=>{n[e]&&o.push(...n[e].split(","))});let i=o.map(t=>{let n=t.trim().split(":")[0];return n.includes("@")&&(n=n.split("@").pop()),n}).filter(t=>t&&e[t]).map(t=>e[t]);i.length>0&&(t[r]=t[r]||[],t[r].push(...i))});if(m==="target")return t;let n={};let a={};d.u.forEach(e=>{a[e.Name]=e.Users?e.Users.split(",").map(e=>e.trim()).filter(e=>""!==e):[]});d.a.forEach(r=>{let o=r["Usergroup name"],i=r["Targetgroup name"];if(a[o]&&t[i]){a[o].forEach(e=>{n[e]=n[e]||new Set;t[i].forEach(t=>n[e].add(t))})}});for(let s in n)n[s]=Array.from(n[s]);return n}class N{constructor(){this.l=null;this.r=null;this.u=new Set()}}class T{constructor(){this.root=new N;this.a={}}ins(e,t){let n=t.split(".").map(Number).map(e=>e.toString(2).padStart(8,"0")).join(""),r=this.root;for(let o of n)"0"===o?(r.l||(r.l=new N),r=r.l):(r.r||(r.r=new N),r=r.r);r.u.add(e)}opt(){this.p(this.root,"",0);return this.a}p(e,t,n){if(!e)return{u:new Set,a:!1};if(32===n)return{u:e.u,a:e.u.size>0};let r=this.p(e.l,t+"0",n+1),o=this.p(e.r,t+"1",n+1),i=new Set;r.u.forEach(e=>{o.u.has(e)&&i.add(e)});let s=(r.a?1:0)+(o.a?1:0),l=1;if(new Set([...r.u].filter(e=>!i.has(e))).size>0)l++;if(new Set([...o.u].filter(e=>!i.has(e))).size>0)l++;if(i.size>0&&l<s){this.reg(new Set([...r.u].filter(e=>!i.has(e))),t+"0",n+1);this.reg(new Set([...o.u].filter(e=>!i.has(e))),t+"1",n+1);return{u:i,a:!0}}else{this.reg(r.u,t+"0",n+1);this.reg(o.u,t+"1",n+1);return{u:new Set,a:!1}}}reg(e,t,n){if(0===e.size)return;let r=t.padEnd(32,"0"),o=[];for(let i=0;i<32;i+=8)o.push(parseInt(r.substring(i,i+8),2));let a=o.join(".")+"/"+n;e.forEach(e=>{this.a[e]=this.a[e]||[],this.a[e].push(a)})}}function handleThemeChange(){const t=document.getElementById("theme-mode-toggle");if(t.checked){document.body.classList.add("dark-mode");}else{document.body.classList.remove("dark-mode");}}document.addEventListener("DOMContentLoaded",()=>{let e=document.getElementById("drop-area"),t=document.getElementById("fileElem");e.addEventListener("click",()=>t.click());t.addEventListener("change",e=>handle(e.target.files));["dragenter","dragover","dragleave","drop"].forEach(t=>{e.addEventListener(t,e=>{e.preventDefault();e.stopPropagation()},!1)});["dragenter","dragover"].forEach(t=>{e.addEventListener(t,()=>e.classList.add("highlight"),!1)});["dragleave","drop"].forEach(t=>{e.addEventListener(t,()=>e.classList.remove("highlight"),!1)});e.addEventListener("drop",e=>handle(e.dataTransfer.files),!1)});</script></body></html>